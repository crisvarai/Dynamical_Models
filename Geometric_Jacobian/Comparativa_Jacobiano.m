 clear all 
 close all 
 clc
 %%
 % parametros del robot
syms k d1 a2 a3 d3 a4 d5 d7
% variables articulares 
syms q1 q2 q3 q4 q5 q6 
% velocidades angulares 
syms w1 w2 w3 w4 w5 w6

%% -- Parametros del brazo del Robot Prometheus
 d1=183.73/1000;
 a2=58.28/1000;
 d3=244.4/1000; 
 a3=13.76+5/1000;
 a4=18.53/1000;
 d5=78.53+44.5/1000;
 d7=150/1000;
 k=((65*pi)/180);
 %----- Angulo de giro de cada motor 
%                       %Rango de trabajo
  q1=0*pi/180;         % -20<q1<180
  q2=0*pi/180;         % -45<q2<125
  q3=0*pi/180;         % -45<q3<180
  q4=0*pi/180;         %  0<q4<135
  q5=0*pi/180;         %  -180<q5<180
  q6=0*pi/180;         %  -90<q6<90
%% Charly
J = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       a4*cos(k)*sin(q1)*sin(q2)*sin(q4) - d7*(sin(q6)*(sin(q5)*(cos(k)*cos(q1)*cos(q3) - cos(k)*cos(q2)*sin(q1)*sin(q3)) + cos(q5)*(cos(q4)*(cos(k)*cos(q1)*sin(q3) + cos(k)*cos(q2)*cos(q3)*sin(q1)) - cos(k)*sin(q1)*sin(q2)*sin(q4))) + cos(q6)*(sin(q4)*(cos(k)*cos(q1)*sin(q3) + cos(k)*cos(q2)*cos(q3)*sin(q1)) + cos(k)*cos(q4)*sin(q1)*sin(q2))) - a4*cos(q4)*(cos(k)*cos(q1)*sin(q3) + cos(k)*cos(q2)*cos(q3)*sin(q1)) - a2*cos(k)*cos(q2)*sin(q1) - a3*cos(k)*cos(q1)*sin(q3) - d3*cos(k)*sin(q1)*sin(q2) - a3*cos(k)*cos(q2)*cos(q3)*sin(q1) - d5*(sin(q4)*(cos(k)*cos(q1)*sin(q3) + cos(k)*cos(q2)*cos(q3)*sin(q1)) + cos(k)*cos(q4)*sin(q1)*sin(q2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   d3*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + d5*(cos(q4)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(q3)*sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + d7*(cos(q6)*(cos(q4)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(q3)*sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) - sin(q6)*(cos(q5)*(sin(q4)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(q3)*cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + sin(q3)*sin(q5)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) + a2*cos(q2)*sin(k) + a3*cos(q3)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)) - a4*sin(q4)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - a2*cos(k)*cos(q1)*sin(q2) + a4*cos(q3)*cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  - d7*(sin(q6)*(sin(q5)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + cos(q4)*cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1))) + cos(q6)*sin(q4)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1))) - a4*cos(q4)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - d5*sin(q4)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - a3*sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - a3*cos(k)*cos(q3)*sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        d7*(cos(q6)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) - cos(q5)*sin(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) + d5*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) - a4*sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + a4*cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -d7*sin(q6)*(cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -d7*(sin(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + cos(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     a2*cos(q1)*cos(q2) - d7*(cos(q6)*(sin(q4)*(sin(q1)*sin(q3) - cos(q1)*cos(q2)*cos(q3)) - cos(q1)*cos(q4)*sin(q2)) + sin(q6)*(cos(q5)*(cos(q4)*(sin(q1)*sin(q3) - cos(q1)*cos(q2)*cos(q3)) + cos(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q3)*sin(q1) + cos(q1)*cos(q2)*sin(q3)))) - d5*(sin(q4)*(sin(q1)*sin(q3) - cos(q1)*cos(q2)*cos(q3)) - cos(q1)*cos(q4)*sin(q2)) + d3*cos(q1)*sin(q2) - a3*sin(q1)*sin(q3) - a4*cos(q4)*(sin(q1)*sin(q3) - cos(q1)*cos(q2)*cos(q3)) + a3*cos(q1)*cos(q2)*cos(q3) - a4*cos(q1)*sin(q2)*sin(q4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            -sin(q1)*(a2*sin(q2) - d3*cos(q2) - d5*cos(q2)*cos(q4) + a3*cos(q3)*sin(q2) + a4*cos(q2)*sin(q4) - d7*cos(q2)*cos(q4)*cos(q6) + a4*cos(q3)*cos(q4)*sin(q2) + d5*cos(q3)*sin(q2)*sin(q4) + d7*cos(q3)*cos(q6)*sin(q2)*sin(q4) + d7*cos(q2)*cos(q5)*sin(q4)*sin(q6) - d7*sin(q2)*sin(q3)*sin(q5)*sin(q6) + d7*cos(q3)*cos(q4)*cos(q5)*sin(q2)*sin(q6)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          d5*sin(q4)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)) - d7*(sin(q6)*(sin(q5)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - cos(q4)*cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))) - cos(q6)*sin(q4)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))) + a3*cos(q1)*cos(q3) + a4*cos(q4)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)) - a3*cos(q2)*sin(q1)*sin(q3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    d7*(cos(q6)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) - cos(q5)*sin(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2))) + d5*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) - a4*sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - a4*cos(q4)*sin(q1)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               -d7*sin(q6)*(sin(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) - cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         -d7*(sin(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) - cos(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       a4*sin(k)*sin(q1)*sin(q2)*sin(q4) - d7*(cos(q6)*(sin(q4)*(cos(q1)*sin(k)*sin(q3) + cos(q2)*cos(q3)*sin(k)*sin(q1)) + cos(q4)*sin(k)*sin(q1)*sin(q2)) + sin(q6)*(sin(q5)*(cos(q1)*cos(q3)*sin(k) - cos(q2)*sin(k)*sin(q1)*sin(q3)) + cos(q5)*(cos(q4)*(cos(q1)*sin(k)*sin(q3) + cos(q2)*cos(q3)*sin(k)*sin(q1)) - sin(k)*sin(q1)*sin(q2)*sin(q4)))) - a4*cos(q4)*(cos(q1)*sin(k)*sin(q3) + cos(q2)*cos(q3)*sin(k)*sin(q1)) - a2*cos(q2)*sin(k)*sin(q1) - a3*cos(q1)*sin(k)*sin(q3) - d3*sin(k)*sin(q1)*sin(q2) - a3*cos(q2)*cos(q3)*sin(k)*sin(q1) - d5*(sin(q4)*(cos(q1)*sin(k)*sin(q3) + cos(q2)*cos(q3)*sin(k)*sin(q1)) + cos(q4)*sin(k)*sin(q1)*sin(q2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   a4*sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - d5*(cos(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + cos(q3)*sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - d7*(cos(q6)*(cos(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + cos(q3)*sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - sin(q6)*(cos(q5)*(sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + sin(q3)*sin(q5)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - a2*cos(k)*cos(q2) - a3*cos(q3)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)) - d3*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - a2*cos(q1)*sin(k)*sin(q2) - a4*cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    d7*(sin(q6)*(sin(q5)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + cos(q4)*cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) + cos(q6)*sin(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) + a4*cos(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + d5*sin(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + a3*sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - a3*cos(q3)*sin(k)*sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        a4*sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - d5*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - d7*(cos(q6)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - cos(q5)*sin(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - a4*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    d7*sin(q6)*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   d7*(cos(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + sin(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))));
                                                                                                                                                                                                                                                                                                                                                                                                             (sin(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) - cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))*(cos(q5)*(cos(q1)*cos(q3)*sin(k) - cos(q2)*sin(k)*sin(q1)*sin(q3)) - sin(q5)*(cos(q4)*(cos(q1)*sin(k)*sin(q3) + cos(q2)*cos(q3)*sin(k)*sin(q1)) - sin(k)*sin(q1)*sin(q2)*sin(q4))) - (cos(q6)*(sin(q4)*(cos(q1)*sin(k)*sin(q3) + cos(q2)*cos(q3)*sin(k)*sin(q1)) + cos(q4)*sin(k)*sin(q1)*sin(q2)) + sin(q6)*(sin(q5)*(cos(q1)*cos(q3)*sin(k) - cos(q2)*sin(k)*sin(q1)*sin(q3)) + cos(q5)*(cos(q4)*(cos(q1)*sin(k)*sin(q3) + cos(q2)*cos(q3)*sin(k)*sin(q1)) - sin(k)*sin(q1)*sin(q2)*sin(q4))))*(cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))) + (cos(q6)*(sin(q5)*(cos(q1)*cos(q3)*sin(k) - cos(q2)*sin(k)*sin(q1)*sin(q3)) + cos(q5)*(cos(q4)*(cos(q1)*sin(k)*sin(q3) + cos(q2)*cos(q3)*sin(k)*sin(q1)) - sin(k)*sin(q1)*sin(q2)*sin(q4))) - sin(q6)*(sin(q4)*(cos(q1)*sin(k)*sin(q3) + cos(q2)*cos(q3)*sin(k)*sin(q1)) + cos(q4)*sin(k)*sin(q1)*sin(q2)))*(sin(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) - cos(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))),                                                                                                                                                                                                                                                                                                                                                                                                           (sin(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) - cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))*(sin(q5)*(sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - cos(q5)*sin(q3)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - (cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))))*(cos(q6)*(cos(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + cos(q3)*sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - sin(q6)*(cos(q5)*(sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + sin(q3)*sin(q5)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - (sin(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) - cos(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))))*(sin(q6)*(cos(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + cos(q3)*sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + cos(q6)*(cos(q5)*(sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + sin(q3)*sin(q5)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))),                                                                                                                                                                                                                                                                                                                                                                                                             (cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))))*(sin(q6)*(sin(q5)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + cos(q4)*cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) + cos(q6)*sin(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) - (sin(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) - cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))*(cos(q5)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) - (sin(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) - cos(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))))*(cos(q6)*(sin(q5)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + cos(q4)*cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) - sin(q4)*sin(q6)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))),                                                                                                                                                                                                                                                                                                                                                                                                           sin(q5)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))*(sin(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) - cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))) - (sin(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) - cos(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))))*(sin(q6)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + cos(q5)*cos(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - (cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))))*(cos(q6)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - cos(q5)*sin(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))),                                                                                                                                                                                                                                                                                                                                                                                                           (sin(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) - cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - cos(q6)*(sin(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) - cos(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))))*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + sin(q6)*(cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))))*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))), (cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))))*(cos(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + sin(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + (sin(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) - cos(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))))*(sin(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - cos(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))));
- (cos(q5)*(cos(k)*cos(q1)*cos(q3) - cos(k)*cos(q2)*sin(q1)*sin(q3)) - sin(q5)*(cos(q4)*(cos(k)*cos(q1)*sin(q3) + cos(k)*cos(q2)*cos(q3)*sin(q1)) - cos(k)*sin(q1)*sin(q2)*sin(q4)))*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - (sin(q6)*(sin(q5)*(cos(k)*cos(q1)*cos(q3) - cos(k)*cos(q2)*sin(q1)*sin(q3)) + cos(q5)*(cos(q4)*(cos(k)*cos(q1)*sin(q3) + cos(k)*cos(q2)*cos(q3)*sin(q1)) - cos(k)*sin(q1)*sin(q2)*sin(q4))) + cos(q6)*(sin(q4)*(cos(k)*cos(q1)*sin(q3) + cos(k)*cos(q2)*cos(q3)*sin(q1)) + cos(k)*cos(q4)*sin(q1)*sin(q2)))*(sin(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - cos(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - (cos(q6)*(sin(q5)*(cos(k)*cos(q1)*cos(q3) - cos(k)*cos(q2)*sin(q1)*sin(q3)) + cos(q5)*(cos(q4)*(cos(k)*cos(q1)*sin(q3) + cos(k)*cos(q2)*cos(q3)*sin(q1)) - cos(k)*sin(q1)*sin(q2)*sin(q4))) - sin(q6)*(sin(q4)*(cos(k)*cos(q1)*sin(q3) + cos(k)*cos(q2)*cos(q3)*sin(q1)) + cos(k)*cos(q4)*sin(q1)*sin(q2)))*(cos(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + sin(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))), (sin(q5)*(sin(q4)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(q3)*cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) - cos(q5)*sin(q3)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - (sin(q6)*(cos(q4)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(q3)*sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + cos(q6)*(cos(q5)*(sin(q4)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(q3)*cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + sin(q3)*sin(q5)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))*(cos(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + sin(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + (cos(q6)*(cos(q4)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(q3)*sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) - sin(q6)*(cos(q5)*(sin(q4)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(q3)*cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + sin(q3)*sin(q5)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))*(sin(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - cos(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))), - (sin(q6)*(sin(q5)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + cos(q4)*cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1))) + cos(q6)*sin(q4)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)))*(sin(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - cos(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - (cos(q6)*(sin(q5)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + cos(q4)*cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1))) - sin(q4)*sin(q6)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)))*(cos(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + sin(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - (cos(q5)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)))*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))), (cos(q6)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) - cos(q5)*sin(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))*(sin(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - cos(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - (sin(q6)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + cos(q5)*cos(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))*(cos(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + sin(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + sin(q5)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))), (sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - cos(q6)*(cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))*(cos(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + sin(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - sin(q6)*(cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))*(sin(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - cos(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         cos(q1)*cos(q3)*cos(q5) - cos(q2)*cos(q5)*sin(q1)*sin(q3) - cos(q1)*cos(q4)*sin(q3)*sin(q5) + sin(q1)*sin(q2)*sin(q4)*sin(q5) - cos(q2)*cos(q3)*cos(q4)*sin(q1)*sin(q5);
                                                                                                                                                     (sin(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) - cos(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))*(cos(q6)*(sin(q4)*(sin(q1)*sin(q3) - cos(q1)*cos(q2)*cos(q3)) - cos(q1)*cos(q4)*sin(q2)) + sin(q6)*(cos(q5)*(cos(q4)*(sin(q1)*sin(q3) - cos(q1)*cos(q2)*cos(q3)) + cos(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q3)*sin(q1) + cos(q1)*cos(q2)*sin(q3)))) - (sin(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + cos(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))))*(sin(q6)*(sin(q4)*(sin(q1)*sin(q3) - cos(q1)*cos(q2)*cos(q3)) - cos(q1)*cos(q4)*sin(q2)) - cos(q6)*(cos(q5)*(cos(q4)*(sin(q1)*sin(q3) - cos(q1)*cos(q2)*cos(q3)) + cos(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q3)*sin(q1) + cos(q1)*cos(q2)*sin(q3)))) - (sin(q5)*(cos(q4)*(sin(q1)*sin(q3) - cos(q1)*cos(q2)*cos(q3)) + cos(q1)*sin(q2)*sin(q4)) - cos(q5)*(cos(q3)*sin(q1) + cos(q1)*cos(q2)*sin(q3)))*(cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))),                                                                                                                                                                                                                                                                                                                                                   (sin(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + cos(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))))*(sin(q6)*(cos(q2)*cos(q4)*sin(q1) - cos(q3)*sin(q1)*sin(q2)*sin(q4)) + cos(q6)*(cos(q5)*(cos(q2)*sin(q1)*sin(q4) + cos(q3)*cos(q4)*sin(q1)*sin(q2)) - sin(q1)*sin(q2)*sin(q3)*sin(q5))) - (sin(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) - cos(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))*(cos(q6)*(cos(q2)*cos(q4)*sin(q1) - cos(q3)*sin(q1)*sin(q2)*sin(q4)) - sin(q6)*(cos(q5)*(cos(q2)*sin(q1)*sin(q4) + cos(q3)*cos(q4)*sin(q1)*sin(q2)) - sin(q1)*sin(q2)*sin(q3)*sin(q5))) - (sin(q5)*(cos(q2)*sin(q1)*sin(q4) + cos(q3)*cos(q4)*sin(q1)*sin(q2)) + cos(q5)*sin(q1)*sin(q2)*sin(q3))*(cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))),                                                                                                                                                                                                                                                                           (cos(q5)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))*(cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) + (cos(q6)*(sin(q5)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - cos(q4)*cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))) + sin(q4)*sin(q6)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))*(sin(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + cos(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))) + (sin(q6)*(sin(q5)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - cos(q4)*cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))) - cos(q6)*sin(q4)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))*(sin(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) - cos(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))),                                                                                                                                                                                                                                                                                                        (sin(q6)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + cos(q5)*cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)))*(sin(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + cos(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))) - (cos(q6)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) - cos(q5)*sin(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)))*(sin(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) - cos(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) - sin(q5)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2))*(cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))),                                                                                                                                                                                                                                                                                     (cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))*(cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) + cos(q6)*(sin(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) - cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))*(sin(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + cos(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))) + sin(q6)*(sin(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) - cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))*(sin(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) - cos(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))), (cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))))*(sin(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + cos(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))) + (sin(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) - cos(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))))*(sin(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) - cos(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))]
 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               -sin(k)*sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)) - sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))]
%% Luis
JG =[                                                                                                       -cos(k)*(d5*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + a2*cos(q2)*sin(q1) + a3*cos(q1)*sin(q3) + d3*sin(q1)*sin(q2) + d7*cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + d7*sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))) + a4*cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + a3*cos(q2)*cos(q3)*sin(q1) - a4*sin(q1)*sin(q2)*sin(q4)), a2*cos(q2)*sin(k) + d3*sin(k)*sin(q2) + d3*cos(k)*cos(q1)*cos(q2) - a2*cos(k)*cos(q1)*sin(q2) + a3*cos(q2)*cos(q3)*sin(k) + d5*cos(q4)*sin(k)*sin(q2) - a4*sin(k)*sin(q2)*sin(q4) + d5*cos(k)*cos(q1)*cos(q2)*cos(q4) - a3*cos(k)*cos(q1)*cos(q3)*sin(q2) - a4*cos(k)*cos(q1)*cos(q2)*sin(q4) + a4*cos(q2)*cos(q3)*cos(q4)*sin(k) + d5*cos(q2)*cos(q3)*sin(k)*sin(q4) + d7*cos(q4)*cos(q6)*sin(k)*sin(q2) - d5*cos(k)*cos(q1)*cos(q3)*sin(q2)*sin(q4) + d7*cos(q2)*cos(q3)*cos(q6)*sin(k)*sin(q4) - d7*cos(q2)*sin(k)*sin(q3)*sin(q5)*sin(q6) - d7*cos(q5)*sin(k)*sin(q2)*sin(q4)*sin(q6) + d7*cos(k)*cos(q1)*cos(q2)*cos(q4)*cos(q6) - a4*cos(k)*cos(q1)*cos(q3)*cos(q4)*sin(q2) - d7*cos(k)*cos(q1)*cos(q3)*cos(q6)*sin(q2)*sin(q4) - d7*cos(k)*cos(q1)*cos(q2)*cos(q5)*sin(q4)*sin(q6) + d7*cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(k)*sin(q6) + d7*cos(k)*cos(q1)*sin(q2)*sin(q3)*sin(q5)*sin(q6) - d7*cos(k)*cos(q1)*cos(q3)*cos(q4)*cos(q5)*sin(q2)*sin(q6), d7*cos(k)*sin(q1)*sin(q3)*sin(q5)*sin(q6) - a3*sin(k)*sin(q2)*sin(q3) - a3*cos(k)*cos(q1)*cos(q2)*sin(q3) - a4*cos(k)*cos(q3)*cos(q4)*sin(q1) - d5*cos(k)*cos(q3)*sin(q1)*sin(q4) - a4*cos(q4)*sin(k)*sin(q2)*sin(q3) - d5*sin(k)*sin(q2)*sin(q3)*sin(q4) - d5*cos(k)*cos(q1)*cos(q2)*sin(q3)*sin(q4) - d7*cos(k)*cos(q3)*cos(q6)*sin(q1)*sin(q4) - a3*cos(k)*cos(q3)*sin(q1) - d7*cos(q6)*sin(k)*sin(q2)*sin(q3)*sin(q4) - d7*cos(q3)*sin(k)*sin(q2)*sin(q5)*sin(q6) - a4*cos(k)*cos(q1)*cos(q2)*cos(q4)*sin(q3) - d7*cos(k)*cos(q1)*cos(q2)*cos(q6)*sin(q3)*sin(q4) - d7*cos(k)*cos(q1)*cos(q2)*cos(q3)*sin(q5)*sin(q6) - d7*cos(k)*cos(q3)*cos(q4)*cos(q5)*sin(q1)*sin(q6) - d7*cos(q4)*cos(q5)*sin(k)*sin(q2)*sin(q3)*sin(q6) - d7*cos(k)*cos(q1)*cos(q2)*cos(q4)*cos(q5)*sin(q3)*sin(q6), - (sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))*(d5*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + d7*cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + d7*sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))) + a4*cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - a4*sin(q1)*sin(q2)*sin(q4)) - (cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))*(d5*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + a4*cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - d7*sin(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + d7*cos(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + a4*sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))), (sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))*(d5*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + d7*cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + d7*sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))) - (sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2))*(d5*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - d7*sin(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + d7*cos(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))),                                                                                                                                                                                                                                                  - (d7*cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + d7*sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))))*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - (sin(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) - cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))*(d7*sin(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - d7*cos(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))));
a2*cos(q1)*cos(q2) + d3*cos(q1)*sin(q2) - a3*sin(q1)*sin(q3) + a3*cos(q1)*cos(q2)*cos(q3) + d5*cos(q1)*cos(q4)*sin(q2) - a4*cos(q1)*sin(q2)*sin(q4) - a4*cos(q4)*sin(q1)*sin(q3) - d5*sin(q1)*sin(q3)*sin(q4) + a4*cos(q1)*cos(q2)*cos(q3)*cos(q4) + d5*cos(q1)*cos(q2)*cos(q3)*sin(q4) + d7*cos(q1)*cos(q4)*cos(q6)*sin(q2) - d7*cos(q6)*sin(q1)*sin(q3)*sin(q4) - d7*cos(q3)*sin(q1)*sin(q5)*sin(q6) - d7*cos(q1)*cos(q2)*sin(q3)*sin(q5)*sin(q6) - d7*cos(q1)*cos(q5)*sin(q2)*sin(q4)*sin(q6) - d7*cos(q4)*cos(q5)*sin(q1)*sin(q3)*sin(q6) + d7*cos(q1)*cos(q2)*cos(q3)*cos(q6)*sin(q4) + d7*cos(q1)*cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(q6),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -sin(q1)*(a2*sin(q2) - d3*cos(q2) - d5*cos(q2)*cos(q4) + a3*cos(q3)*sin(q2) + a4*cos(q2)*sin(q4) - d7*cos(q2)*cos(q4)*cos(q6) + a4*cos(q3)*cos(q4)*sin(q2) + d5*cos(q3)*sin(q2)*sin(q4) + d7*cos(q3)*cos(q6)*sin(q2)*sin(q4) + d7*cos(q2)*cos(q5)*sin(q4)*sin(q6) - d7*sin(q2)*sin(q3)*sin(q5)*sin(q6) + d7*cos(q3)*cos(q4)*cos(q5)*sin(q2)*sin(q6)),                                                                                                                                                                                                                                                                                                                                     a3*cos(q1)*cos(q3) + a4*cos(q1)*cos(q3)*cos(q4) + d5*cos(q1)*cos(q3)*sin(q4) - a3*cos(q2)*sin(q1)*sin(q3) + d7*cos(q1)*cos(q3)*cos(q6)*sin(q4) - a4*cos(q2)*cos(q4)*sin(q1)*sin(q3) - d5*cos(q2)*sin(q1)*sin(q3)*sin(q4) - d7*cos(q1)*sin(q3)*sin(q5)*sin(q6) - d7*cos(q2)*cos(q6)*sin(q1)*sin(q3)*sin(q4) - d7*cos(q2)*cos(q3)*sin(q1)*sin(q5)*sin(q6) + d7*cos(q1)*cos(q3)*cos(q4)*cos(q5)*sin(q6) - d7*cos(q2)*cos(q4)*cos(q5)*sin(q1)*sin(q3)*sin(q6),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   d5*cos(q1)*cos(q4)*sin(q3) - a4*cos(q4)*sin(q1)*sin(q2) - a4*cos(q1)*sin(q3)*sin(q4) - d5*sin(q1)*sin(q2)*sin(q4) + d5*cos(q2)*cos(q3)*cos(q4)*sin(q1) + d7*cos(q1)*cos(q4)*cos(q6)*sin(q3) - a4*cos(q2)*cos(q3)*sin(q1)*sin(q4) - d7*cos(q6)*sin(q1)*sin(q2)*sin(q4) - d7*cos(q4)*cos(q5)*sin(q1)*sin(q2)*sin(q6) - d7*cos(q1)*cos(q5)*sin(q3)*sin(q4)*sin(q6) + d7*cos(q2)*cos(q3)*cos(q4)*cos(q6)*sin(q1) - d7*cos(q2)*cos(q3)*cos(q5)*sin(q1)*sin(q4)*sin(q6),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -d7*sin(q6)*(cos(q2)*cos(q5)*sin(q1)*sin(q3) - cos(q1)*cos(q3)*cos(q5) + cos(q1)*cos(q4)*sin(q3)*sin(q5) - sin(q1)*sin(q2)*sin(q4)*sin(q5) + cos(q2)*cos(q3)*cos(q4)*sin(q1)*sin(q5)), (d7*sin(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - d7*cos(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))))*(cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) - (d7*sin(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) - d7*cos(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))));
                                                                                                       -sin(k)*(d5*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + a2*cos(q2)*sin(q1) + a3*cos(q1)*sin(q3) + d3*sin(q1)*sin(q2) + d7*cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + d7*sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))) + a4*cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + a3*cos(q2)*cos(q3)*sin(q1) - a4*sin(q1)*sin(q2)*sin(q4)), d3*cos(q1)*cos(q2)*sin(k) - d3*cos(k)*sin(q2) - a3*cos(k)*cos(q2)*cos(q3) - a2*cos(k)*cos(q2) - d5*cos(k)*cos(q4)*sin(q2) - a2*cos(q1)*sin(k)*sin(q2) + a4*cos(k)*sin(q2)*sin(q4) - a4*cos(k)*cos(q2)*cos(q3)*cos(q4) + d5*cos(q1)*cos(q2)*cos(q4)*sin(k) - d5*cos(k)*cos(q2)*cos(q3)*sin(q4) - d7*cos(k)*cos(q4)*cos(q6)*sin(q2) - a3*cos(q1)*cos(q3)*sin(k)*sin(q2) - a4*cos(q1)*cos(q2)*sin(k)*sin(q4) - a4*cos(q1)*cos(q3)*cos(q4)*sin(k)*sin(q2) - d5*cos(q1)*cos(q3)*sin(k)*sin(q2)*sin(q4) + d7*cos(k)*cos(q2)*sin(q3)*sin(q5)*sin(q6) + d7*cos(k)*cos(q5)*sin(q2)*sin(q4)*sin(q6) + d7*cos(q1)*cos(q2)*cos(q4)*cos(q6)*sin(k) - d7*cos(k)*cos(q2)*cos(q3)*cos(q6)*sin(q4) + d7*cos(q1)*sin(k)*sin(q2)*sin(q3)*sin(q5)*sin(q6) - d7*cos(k)*cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(q6) - d7*cos(q1)*cos(q3)*cos(q6)*sin(k)*sin(q2)*sin(q4) - d7*cos(q1)*cos(q2)*cos(q5)*sin(k)*sin(q4)*sin(q6) - d7*cos(q1)*cos(q3)*cos(q4)*cos(q5)*sin(k)*sin(q2)*sin(q6), a3*cos(k)*sin(q2)*sin(q3) - a3*cos(q3)*sin(k)*sin(q1) - a3*cos(q1)*cos(q2)*sin(k)*sin(q3) - a4*cos(q3)*cos(q4)*sin(k)*sin(q1) + a4*cos(k)*cos(q4)*sin(q2)*sin(q3) - d5*cos(q3)*sin(k)*sin(q1)*sin(q4) + d5*cos(k)*sin(q2)*sin(q3)*sin(q4) - a4*cos(q1)*cos(q2)*cos(q4)*sin(k)*sin(q3) - d5*cos(q1)*cos(q2)*sin(k)*sin(q3)*sin(q4) - d7*cos(q3)*cos(q6)*sin(k)*sin(q1)*sin(q4) + d7*cos(k)*cos(q6)*sin(q2)*sin(q3)*sin(q4) + d7*cos(k)*cos(q3)*sin(q2)*sin(q5)*sin(q6) + d7*sin(k)*sin(q1)*sin(q3)*sin(q5)*sin(q6) - d7*cos(q1)*cos(q2)*cos(q6)*sin(k)*sin(q3)*sin(q4) - d7*cos(q1)*cos(q2)*cos(q3)*sin(k)*sin(q5)*sin(q6) - d7*cos(q3)*cos(q4)*cos(q5)*sin(k)*sin(q1)*sin(q6) + d7*cos(k)*cos(q4)*cos(q5)*sin(q2)*sin(q3)*sin(q6) - d7*cos(q1)*cos(q2)*cos(q4)*cos(q5)*sin(k)*sin(q3)*sin(q6), - (sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1))*(d5*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + d7*cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + d7*sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))) + a4*cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - a4*sin(q1)*sin(q2)*sin(q4)) - (cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3))*(d5*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) - d7*sin(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) + a4*cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + d7*cos(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) + a4*sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))), (sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))*(d5*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + d7*cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + d7*sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))) - (sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2))*(d5*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))) - d7*sin(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) + d7*cos(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))),                                                                                                                                                                                                                                                  - (cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))))*(d7*cos(q6)*(sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2)) + d7*sin(q6)*(cos(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) + sin(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))) - (sin(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4)) - cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)))*(d7*sin(q6)*(sin(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)))) - d7*cos(q6)*(sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2))));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -sin(k),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               -cos(k)*sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       cos(k)*cos(q1)*sin(q2) - cos(q2)*sin(k),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        - sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*cos(q3)*sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     sin(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 - cos(q5)*(sin(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) + cos(k)*cos(q3)*sin(q1)) - sin(q5)*(cos(q4)*(cos(q3)*(sin(k)*sin(q2) + cos(k)*cos(q1)*cos(q2)) - cos(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(q2)*sin(k) - cos(k)*cos(q1)*sin(q2)));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       cos(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               sin(q1)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                sin(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) + cos(q4)*sin(q1)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               cos(q5)*(cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3)) - sin(q5)*(cos(q4)*(cos(q1)*sin(q3) + cos(q2)*cos(q3)*sin(q1)) - sin(q1)*sin(q2)*sin(q4));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         cos(k),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               -sin(k)*sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)) - sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))]
 